{# templates/community/challenge_outbox.html.twig #}
{% extends "base.html.twig" %}

{% block title %}My Challenges Sent | MindForge Community{% endblock %}

{% block body %}
<div style="min-height: 100vh; background: linear-gradient(135deg, #f8f9fa 0%, #e8eaed 100%); padding: 3rem 1rem;">
    <div class="container">
        <!-- Header -->
        <div style="text-align: center; margin-bottom: 2rem;">
            <h1 style="color: #2d3436; font-size: 2.5rem; font-weight: 700; margin-bottom: 0.5rem;">
                <i class="fa fa-send" style="color: #6d5ce7;"></i> Challenges I've Sent
            </h1>
            <p style="color: #636e72; font-size: 1.1rem;">Track the challenges you've shared with your friends</p>
        </div>

        <!-- Flash Messages -->
        {% if app.flashes %}
            {% for type, messages in app.flashes %}
                {% for message in messages %}
                    <div class="alert alert-{{ type }}" style="margin-bottom: 1.5rem;">
                        <i class="fa fa-{{ type == 'error' ? 'exclamation-circle' : 'check-circle' }}"></i>
                        {{ message }}
                    </div>
                {% endfor %}
            {% endfor %}
        {% endif %}

        <!-- Filter Buttons -->
        <div style="display: flex; gap: 0.75rem; margin-bottom: 2rem; flex-wrap: wrap; justify-content: center;">
            <a href="{{ path('community_challenge_outbox') }}" 
               style="padding: 8px 16px; border: 2px solid #6d5ce7; background: transparent; color: #6d5ce7; border-radius: 20px; text-decoration: none; font-weight: 500; transition: all 0.3s; {% if not filterStatus %}background: linear-gradient(135deg, #6d5ce7 0%, #5f3dc4 100%); color: white;{% endif %}"
               onmouseover="this.style.background='linear-gradient(135deg, #6d5ce7 0%, #5f3dc4 100%)'; this.style.color='white';"
               onmouseout="{% if not filterStatus %}{% else %}this.style.background='transparent'; this.style.color='#6d5ce7';{% endif %}">
                All
            </a>
            <a href="{{ path('community_challenge_outbox', {'status': 'pending'}) }}" 
               style="padding: 8px 16px; border: 2px solid #fdcb6e; background: transparent; color: #fdcb6e; border-radius: 20px; text-decoration: none; font-weight: 500; transition: all 0.3s; {% if filterStatus == 'pending' %}background: #fdcb6e; color: #2d3436;{% endif %}"
               onmouseover="this.style.background='#fdcb6e'; this.style.color='#2d3436';"
               onmouseout="{% if filterStatus == 'pending' %}{% else %}this.style.background='transparent'; this.style.color='#fdcb6e';{% endif %}">
                Pending
            </a>
            <a href="{{ path('community_challenge_outbox', {'status': 'accepted'}) }}" 
               style="padding: 8px 16px; border: 2px solid #00b894; background: transparent; color: #00b894; border-radius: 20px; text-decoration: none; font-weight: 500; transition: all 0.3s; {% if filterStatus == 'accepted' %}background: #00b894; color: white;{% endif %}"
               onmouseover="this.style.background='#00b894'; this.style.color='white';"
               onmouseout="{% if filterStatus == 'accepted' %}{% else %}this.style.background='transparent'; this.style.color='#00b894';{% endif %}">
                Accepted
            </a>
            <a href="{{ path('community_challenge_outbox', {'status': 'rejected'}) }}" 
               style="padding: 8px 16px; border: 2px solid #ff6b6b; background: transparent; color: #ff6b6b; border-radius: 20px; text-decoration: none; font-weight: 500; transition: all 0.3s; {% if filterStatus == 'rejected' %}background: #ff6b6b; color: white;{% endif %}"
               onmouseover="this.style.background='#ff6b6b'; this.style.color='white';"
               onmouseout="{% if filterStatus == 'rejected' %}{% else %}this.style.background='transparent'; this.style.color='#ff6b6b';{% endif %}">
                Rejected
            </a>
            <a href="{{ path('community_challenge_outbox', {'status': 'completed'}) }}" 
               style="padding: 8px 16px; border: 2px solid #0984e3; background: transparent; color: #0984e3; border-radius: 20px; text-decoration: none; font-weight: 500; transition: all 0.3s; {% if filterStatus == 'completed' %}background: #0984e3; color: white;{% endif %}"
               onmouseover="this.style.background='#0984e3'; this.style.color='white';"
               onmouseout="{% if filterStatus == 'completed' %}{% else %}this.style.background='transparent'; this.style.color='#0984e3';{% endif %}">
                Completed
            </a>
        </div>

        <!-- Challenges Grid -->
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
            {% if tasks|length > 0 %}
                {% for task in tasks %}
                    <div class="card" style="border: none; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); border-left: 4px solid {% if task.status == 'pending' %}#fdcb6e{% elseif task.status == 'accepted' %}#00b894{% elseif task.status == 'rejected' %}#ff6b6b{% elseif task.status == 'completed' %}#0984e3{% else %}#6d5ce7{% endif %}; transition: all 0.3s;"
                         onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 20px rgba(0, 0, 0, 0.12)';"
                         onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0, 0, 0, 0.08)';">
                        <div class="card-body">
                            <!-- Challenge Header -->
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                                <h4 style="color: #2d3436; margin: 0; flex: 1; font-weight: 600;">{{ task.title }}</h4>
                                <span class="badge" style="padding: 6px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; white-space: nowrap; margin-left: 0.5rem; {% if task.status == 'pending' %}background-color: rgba(253, 203, 110, 0.15); color: #fdcb6e;{% elseif task.status == 'accepted' %}background-color: rgba(0, 184, 148, 0.15); color: #00b894;{% elseif task.status == 'rejected' %}background-color: rgba(255, 107, 107, 0.15); color: #ff6b6b;{% elseif task.status == 'completed' %}background-color: rgba(9, 132, 227, 0.15); color: #0984e3;{% else %}background-color: rgba(109, 92, 231, 0.15); color: #6d5ce7;{% endif %}">
                                    {{ task.status|capitalize }}
                                </span>
                            </div>

                            <!-- Recipient -->
                            <p style="color: #636e72; margin: 0.5rem 0; font-size: 0.95rem;">
                                <i class="fa fa-user"></i> Sent to: <strong>{{ task.sharedWith.email }}</strong>
                            </p>

                            <!-- Description -->
                            <div style="background-color: #f8f9fa; padding: 1rem; border-radius: 8px; margin: 1rem 0; color: #636e72; line-height: 1.5; font-size: 0.95rem;">
                                {{ task.description|length > 150 ? task.description|slice(0, 150) ~ '...' : task.description }}
                            </div>

                            <!-- Metadata -->
                            <div style="display: flex; flex-direction: column; gap: 0.25rem; margin: 1rem 0; border-top: 1px solid #e8eaed; padding-top: 1rem; color: #95a5a6; font-size: 0.85rem;">
                                <small><i class="fa fa-calendar"></i> Sent: {{ task.createdAt|date('Y-m-d H:i') }}</small>
                                {% if task.respondedAt %}
                                    <small><i class="fa fa-check"></i> Responded: {{ task.respondedAt|date('Y-m-d H:i') }}</small>
                                {% endif %}
                            </div>

                            <!-- Actions -->
                            <div style="margin-top: 1rem;">
                                <a href="{{ path('community_challenge_outbox') }}" class="btn btn-primary" style="width: 100%; text-align: center; padding: 10px 16px;">
                                    View Details
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <!-- Empty State -->
                <div style="grid-column: 1 / -1;">
                    <div class="card" style="text-align: center; padding: 3rem; border: none; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);">
                        <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;">ðŸ“¤</div>
                        <p style="color: #636e72; font-size: 1.05rem; margin: 0;">No challenges sent yet.</p>
                        <a href="{{ path('community_challenge_send') }}" class="btn btn-primary" style="margin-top: 1.5rem; display: inline-block; padding: 10px 24px;">
                            <i class="fa fa-paper-plane"></i> Send Your First Challenge!
                        </a>
                    </div>
                </div>
            {% endif %}
        </div>

        <!-- Action Buttons -->
        <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
            <a href="{{ path('community_challenge_send') }}" class="btn btn-primary" style="padding: 12px 24px;">
                <i class="fa fa-plus"></i> Send New Challenge
            </a>
            <a href="{{ path('community_index') }}" class="btn btn-secondary" style="padding: 12px 24px;">
                <i class="fa fa-arrow-left"></i> Back to Hub
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block stylesheets %}{% endblock %}
